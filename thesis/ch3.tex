\chapter{Results and discussion}
\label{chap:results}

\section{Characteristics of q\textsubscript{1} - q\textsubscript{2} stability diagrams for one electron}

%\subsection{Comparison of simulation and determinant stability criterion}

We will start by looking at the stability diagrams for different $\nicefrac{\Omega_2}{\Omega_1}$ ratios. Starting with \ref{fig:stabil-eta=3}.

\begin{figure}[H]
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/det_q1_0.0-0.1_q2_0.0-0.5_990x990_3.pdf}
  \caption{Determinant}
  \label{fig:det_3}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.1_q2_0.0-0.5_960x960_3.pdf}  
  \caption{Simulation}
  \label{fig:sim_3}
\end{subfigure}
\caption{Stability diagrams for $\nicefrac{\Omega_2}{\Omega_1} = 3$}
\label{fig:stabil-eta=3}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.1_q2_0.0-0.5_960x960_3_1000.png}
	\caption{Average electron velocity for $\nicefrac{\Omega_2}{\Omega_1} = 3$}
	\label{fig:velocityedge-eta=3}
\end{figure}

In the sub-figure \ref{fig:det_3} we can see stable\textit{(dark)} and unstable\textit{(light)} regions of the studied differential equation. The adjacent image shows the stability of an electron based on numerical simulation. In contrast with the determinant solution, we can see that the two stability areas have melted away in the field with higher amplitudes\todo{not entirely sure why...}. The image \ref{fig:velocityedge-eta=3} combines two pictures. The pink curve construes the stable regions simulated for the figure \ref{fig:sim_3}. In the background is a contour plot of the average electron velocity throughout the whole trajectory: $$\langle v \rangle = \dfrac{1}{T_{max}} \int_{0}^{T_{max}} v(\tau) \, d\tau,$$ relative to the initial velocity $v_0$. The color bar to the right indicates the value of this ratio. We create all the other figures similar to \ref{fig:velocityedge-eta=3} in the same way. These diagrams can help us find stable trap parameters while keeping electron temperature as low as possible, which is our ultimate goal.

Moving to larger frequency ratio $\rightarrow \nicefrac{\Omega_2}{\Omega_1} = 13$ we can start to notice some patterns.

\begin{figure}[H]
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/det_q1_0.0-0.07_q2_0.0-0.5_960x960_13.pdf}
  \caption{Determinant}
  \label{fig:det_13}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.05_q2_0.0-0.5_960x960_13.pdf}  
  \caption{Simulation}
  \label{fig:sim_13}
\end{subfigure}
\caption{Stability diagrams for $\nicefrac{\Omega_2}{\Omega_1} = 13$}
\label{fig:velocityedge-eta=13}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.05_q2_0.0-0.5_960x960_13_1000.png}
	\caption{Average electron velocity for $\nicefrac{\Omega_2}{\Omega_1} = 13$}
	\label{fig:stabil-eta=13}
\end{figure}

There emerges one stable triangle with many tongues of instability. With an increasing ratio $\nicefrac{\Omega_2}{\Omega_1}$ we can see a gain in the number of these tongues, but their width promptly shrinks as well. We expect that by further increasing the frequency ratio, the unstable tongues will be realistically affecting only the regions near the edge of stability, leaving the regions further inside a stable triangle safe to work with.

\xxx{Continuing to the frequency ratio compatible for trapping electrons and Ca+ ions}

\begin{figure}[H]
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/det_q1_0.0-0.06_q2_0.0-0.5_300x300_833.pdf}
  \caption{Determinant}
  \label{fig:det_833}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.05_q2_0.0-0.5_960x960_833.pdf}  
  \caption{Simulation}
  \label{fig:sim_833}
\end{subfigure}
\caption{Stability diagrams for $\nicefrac{\Omega_2}{\Omega_1} = 833$}
\label{fig:stabil-eta=833}
\end{figure}

It is worth pointing out that the computation time of the determinant stability diagram already exceeds that of simulated for this frequency ratio. Nevertheless, we apply a built-in NumPy\footnote{NumPy is widely used, open source, numerical python library: \href{https://numpy.org}{https://numpy.org/}} function for computing determinants using LU decomposition \cite{teukolsky1992numerical} with time complexity $\mathcal{O}(n^3)$, not utilizing the fact that our matrices are sparse. Moreover, we are interested only in the sign of a determinant which also suggests a capacity for efficiency improvement. But since the determinant solutions are not essential to us, we do not investigate such further advancements in this thesis.

\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.05_q2_0.0-0.5_960x960_833_1000.png}
	\caption{Simulated stability diagram for $\nicefrac{\Omega_2}{\Omega_1} = 833$}
	\label{fig:stabil-eta=833}
\end{figure}

\subsection{Dependence on initial conditions}

\xxx{work in progress\dots}

\begin{figure}[H]
\begin{subfigure}{.3\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.1_q2_0.0-0.5_960x960_3.pdf}
  \caption{Normal initial conditions}
  \label{fig:normal_conds-3}
\end{subfigure}%
\begin{subfigure}{.3\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.1_q2_0.0-0.5_960x960_3.pdf}
  \caption{High velocity}
  \label{fig:high_velocity-3}
\end{subfigure}%
\begin{subfigure}{.3\textwidth}
  \centering
  \includegraphics[width=\linewidth]{img/0_ions_1_electrons_q1_0.0-0.1_q2_0.0-0.5_960x960_3.pdf}  
  \caption{Further away from center}
  \label{fig:large_radius-3}
\end{subfigure}
\caption{$\nicefrac{\Omega_2}{\Omega_1} = 3$, different initial conditions}
\label{fig:init-conds-eta=3}
\end{figure}

High initial velocity \ref{fig:high_velocity-3} makes the region with the weakest field (around $q_1 \approx q_2 \approx 0$) unstable, which is understandable since the stability condition \xxx{reference} is not satisfied. A wider distance from the trap's center combined with the initial velocity pointing away from the trap \ref{fig:large_radius-3} distorts the stability diagram's shape significantly. 

\xxx{as a sanity check we try to reproduce a result from \cite{leefer2017investigation}.} 

\section{Creating a Coulomb crystal}
\xxx{currently making some useable pictures}

\section{Stability of electron in Coulomb crystal}
\subsection{One electron - one ion}
\subsection{One electron - twenty ions}
\subsection{One electron - a hundred ions}

\section{Design of the experiment}

\section{Future}
\label{chap:future}

Our concerns in the future will be reproducing results of this thesis for the real planar geometry of the trap used in our experiment. The potential of such a trap can be formulated in integral form utilizing Bessel functions, which will make our simulations much more computationally expensive. We need to derive equation of motion and identify parameters analogous to $a$, $q_1$ and $q_2$ which we had for ideal quadrupole trap. After that we can use our exiting program to study stability of particles in dependence on such parameters exactly as we did in this thesis. 